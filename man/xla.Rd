% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/jit.R
\name{xla}
\alias{xla}
\title{Ahead-of-time compile a function to XLA}
\usage{
xla(f, args, donate = character(), device = NULL)
}
\arguments{
\item{f}{(\code{function})\cr
Function to compile. Must accept and return \code{\link{AnvilTensor}}s.}

\item{args}{(\code{list})\cr
List of abstract tensor specifications (e.g. from \code{\link[=nv_aten]{nv_aten()}}) describing the
expected shapes and dtypes of \code{f}'s arguments.}

\item{donate}{(\code{character()})\cr
Names of the arguments whose buffers should be donated.}

\item{device}{(\code{character(1)})\cr
Target device such as \code{"cpu"} (default) or \code{"cuda"}.}
}
\value{
(\code{function})\cr
A function that accepts \code{\link{AnvilTensor}} arguments (matching the flat inputs)
and returns the result as \code{\link{AnvilTensor}}s.
}
\description{
Compiles a function to an XLA executable via tracing.

Returns a callable R function that executes the compiled binary.
Unlike \code{\link[=jit]{jit()}}, compilation happens eagerly at
definition time rather than on first call, so the input shapes and dtypes must be
specified upfront via abstract tensors (see \code{\link[=nv_aten]{nv_aten()}}).
}
\details{
Traces \code{f} with the given abstract \code{args} (via \code{\link[=trace_fn]{trace_fn()}}), lowers the resulting graph
via \code{\link[=stablehlo]{stablehlo()}} and then compiles it to an XLA executable via \code{\link[pjrt:pjrt_compile]{pjrt::pjrt_compile()}}.
and compiles it to an XLA executable immediately.
}
\examples{
\dontshow{if (pjrt::plugin_is_downloaded()) withAutoprint(\{ # examplesIf}
f_compiled <- xla(function(x, y) x + y,
  args = list(x = nv_aten("f32", c(2, 2)), y = nv_aten("f32", c(2, 2)))
)
a <- nv_tensor(array(1:4, c(2, 2)), dtype = "f32")
b <- nv_tensor(array(5:8, c(2, 2)), dtype = "f32")
f_compiled(a, b)
\dontshow{\}) # examplesIf}
}
\seealso{
\code{\link[=jit]{jit()}} for lazy compilation, \code{\link[=compile_to_xla]{compile_to_xla()}} for the lower-level API.
}
