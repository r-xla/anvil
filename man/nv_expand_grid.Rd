% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/api.R
\name{nv_expand_grid}
\alias{nv_expand_grid}
\title{Expand Grid (Cartesian Product)}
\usage{
nv_expand_grid(..., vary_first = FALSE)
}
\arguments{
\item{...}{1-D tensors or scalars whose elements should be combined.}

\item{vary_first}{If \code{TRUE}, the first input varies fastest (like R's \code{expand.grid()}).
If \code{FALSE} (default), the last input varies fastest (row-major order).}
}
\value{
A 2-D tensor of shape \verb{(n_combinations, n_inputs)} where each row
is one combination of elements.
}
\description{
Given a list of 1-D tensors (or scalars), computes all combinations
(Cartesian product) of their elements. This is similar to R's \code{\link[=expand.grid]{expand.grid()}}
but with different ordering.
}
\details{
\strong{Ordering difference from R's \code{expand.grid()}:}

By default, this function uses row-major (C-style) ordering where the \strong{last} input
varies fastest. Set \code{vary_first = TRUE} to use column-major (Fortran-style)
ordering where the \strong{first} input varies fastest, matching R's \code{expand.grid()}.

For example, with inputs \code{c(1, 3)} and \code{c(2, 4)}:
\itemize{
\item \code{nv_expand_grid(..., vary_first = FALSE)} returns: \verb{(1,2), (1,4), (3,2), (3,4)} (last varies fastest)
\item \code{nv_expand_grid(..., vary_first = TRUE)} returns: \verb{(1,2), (3,2), (1,4), (3,4)} (first varies fastest)
}

Both produce the same \strong{set} of combinations, just in different order.
}
\examples{
\dontrun{
# Two inputs with 2 elements each -> 4 combinations
nv_expand_grid(nv_tensor(c(1L, 3L)), nv_tensor(c(2L, 4L)))
# Returns tensor with shape [4, 2]:
# [[1, 2],
#  [1, 4],
#  [3, 2],
#  [3, 4]]

# With vary_first = TRUE (like R's expand.grid)
nv_expand_grid(nv_tensor(c(1L, 3L)), nv_tensor(c(2L, 4L)), vary_first = TRUE)
# Returns tensor with shape [4, 2]:
# [[1, 2],
#  [3, 2],
#  [1, 4],
#  [3, 4]]

# Mix of vectors and scalars
nv_expand_grid(nv_tensor(c(1L, 3L)), nv_scalar(5L), nv_scalar(6L))
# Returns tensor with shape [2, 3]:
# [[1, 5, 6],
#  [3, 5, 6]]
}

}
